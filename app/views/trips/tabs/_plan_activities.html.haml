%div{'ng-cloak' => ''}
  .work-area-header
    .row
      .col-md-12
        = render 'trips/partials/tabs'
    = render 'trips/partials/watching_users'
    .row
      .col-md-12
        = render 'trips/partials/budget', options: {tab_budget: 'activities_other_budget'}
    .row
      .col-md-12
        = render 'trips/partials/buttons'

  .activities
    - @trip.days.each do |day|
      .activity{'ng-controller' => 'ActivitiesDayController', 'ng-init' => "load('#{@trip.id}', '#{day.id}')",
                'ng-show' => 'day_loaded'}
        .row.activity-day-header
          .col-md-12
            .activity-day-date{'ng-click' => 'triggerShowMore()'}
              = day.date_when_s
            - if @user_can_edit && @trip.days_count > 1
              .activity-action-link{'ng-controller' => 'DaySorterController'}
                %a{'ng-click' => "startSorting('#{@trip.id}')", href: 'javascript:void(0);'}
                  = t('trips.show.reorder_days')
        .row.activity-day-places
          .col-md-12
            .activity-day-place.flag-text{'ng-show' => 'place.city_text && place.flag_image && !edit && !day_edit',
              'ng-repeat' => 'place in day.places track by place.id'}
              %span{'ng-bind-html' => 'place.flag_image'}
              {{place.city_text}}
        .row.activity-day-info{'ng-show' => 'expensesPresent() || bookmarksPresent() || day.comment'}
          .col-md-3.col-xs-12.activity-day-add-info{'ng-show' => 'expensesPresent() || bookmarksPresent()'}
            .activity-day-expenses{'ng-show' => 'expensesPresent()'}
              .activity-day-expenses-header
                = image_tag 'common/money.svg'
                = t('trips.show.expenses')

              .activity-day-expense{'ng-repeat' => 'expense in day.expenses track by expense.id'}
                %span{'ng-show' => '!!expense.amount_cents'}
                  {{expense.name}}
                  {{expense.amount_cents / 100.0 | number: 2}}
                  {{expense.amount_currency_text}}

            .activity-day-bookmarks{'ng-show' => 'bookmarksPresent()'}
              .activity-day-bookmarks-header
                = image_tag 'common/link.svg'
                = t('trips.show.links')

              .activity-day-bookmark{'ng-repeat' => 'link in day.links track by link.id'}
                = render 'widgets/link_show', ng_model_url: 'link.url', ng_model_description: 'link.description'

          .col-md-9.col-xs-12{'ng-show' => 'day.comment'}
            .activity-day-comment-header
              = t('trips.show.comments')
            .activity-day-comment
              %p.travel-text{} {{day.comment}}

        .activity-info{'ng-repeat' => 'activity in day.activities track by activity.id'}
          %span{'ng-controller' => 'ActivityController'}
            .row.activity-header{'ng-click' => 'triggerShowMore()'}
              .col-md-12
                %span{'ng-show' => 'day.activities.length > 1'}
                  {{$index+1}}.
                {{activity.name}}
                {{activity.amount_cents / 100.0 | number: 2}}
                {{activity.amount_currency_text}}

                %span.activity-show-more{'ng-class' => '{active: show_more}'}
                  = inline_svg 'common/eye.svg', class: 'activity-show-more-img'

            .row.activity-link{'ng-show' => 'showMore()'}
              .col-md-12
                = render 'widgets/link_show', ng_model_url: 'activity.link_url', ng_model_description: 'activity.link_description'
            .row.activity-comment{'ng-show' => 'showMore()'}
              .col-md-12
                {{activity.comment}}
                %span{'ng-show' => '!activity.comment'}
                  = t('common.no_comments')
        .activity-mockup{'ng-hide' => 'day_loaded'}
          .row
            .col-md-12
              .activity-mockup-day-header
          .row
            .col-md-12
              .activity-mockup-day-places
                .activity-mockup-day-places-place
                .activity-mockup-day-places-place
          .row
            .col-md-3.col-xs-12.activity-mockup-day-info-expenses
              .activity-mockup-day-info-expenses-line
              .activity-mockup-day-info-expenses-line
              .activity-mockup-day-info-expenses-line
            .col-md-9.col-xs-12.activity-mockup-day-info-comment
              .activity-mockup-day-info-comment-line
              .activity-mockup-day-info-comment-line
              .activity-mockup-day-info-comment-line
          .row
            .col-md-12
              .activity-mockup-header
          .row
            .col-md-12
              .activity-mockup-header
          .row
            .col-md-12
              .activity-mockup-header