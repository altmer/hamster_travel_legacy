%div{'ng-cloak' => ''}
  .work-area-header
    .row
      .col-md-12
        = render 'trips/partials/tabs'
    = render 'trips/partials/watching_users'
    .row
      .col-md-12
        = render 'trips/partials/budget', options: {tab_budget: 'activities_other_budget'}
    .row
      .col-md-12
        = render 'trips/partials/buttons'

  .activities
    - @trip.days.each do |day|
      .activity{'ng-controller' => 'ActivitiesDayController', 'ng-init' => "load('#{@trip.id}', '#{day.id}')", 'ng-show' => 'day_loaded'}
        .row.activity-day-header
          .col-md-12
            .activity-day-date
              = day.date_when_s
            - if @user_can_edit && @trip.days_count > 1
              .activity-action-link{'ng-controller' => 'DaySorterController'}
                %a{'ng-click' => "startSorting('#{@trip.id}')", href: 'javascript:void(0);'}
                  = t('trips.show.reorder_days')
        .row.activity-day-places
          .col-md-12
            .activity-day-place.flag-text{'ng-show' => 'place.city_text && place.flag_image && !edit && !day_edit',
              'ng-repeat' => 'place in day.places track by place.id'}
              %span{'ng-bind-html' => 'place.flag_image'}
              {{place.city_text}}
        .row.activity-day-info
          .col-md-3.col-xs-12.activity-day-add-info{'ng-show' => 'expensesPresent() || bookmarksPresent()'}
            .activity-day-expenses{'ng-show' => 'expensesPresent()'}
              .activity-day-expenses-header
                = image_tag 'common/wallet.svg'
                = t('trips.show.expenses')

              .activity-day-expense{'ng-repeat' => 'expense in day.expenses track by expense.id'}
                %span{'ng-show' => '!!expense.amount_cents'}
                  {{expense.name}}
                  {{expense.amount_cents / 100.0 | number: 2}}
                  {{expense.amount_currency_text}}

            .activity-day-bookmarks{'ng-show' => 'bookmarksPresent()'}
              .activity-day-bookmarks-header
                = image_tag 'common/link.svg'
                = t('trips.show.links')

              .activity-day-bookmark{'ng-repeat' => 'link in day.links track by link.id'}
                = render 'widgets/link_show', ng_model_url: 'link.url', ng_model_description: 'link.description'

          .col-md-9.col-xs-12{'ng-show' => 'day.comment'}
            .activity-day-comment-header
              = t('trips.show.comments')
            .activity-day-comment
              %p.travel-text{} {{day.comment}}

        .activity-info{'ng-repeat' => 'activity in day.activities track by activity.id'}
          .row.activity-header
            .col-md-12
              %span{'ng-show' => 'day.activities.length > 1'}
                {{$index+1}}.
              {{activity.name}}
          .row.activity-add-info
            .col-md-3.col-xs-12
            .col-md-9.col-xs-12.activity-comment
              {{activity.comment}}